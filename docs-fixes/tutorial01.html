
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Tutorial 1: Using pyMOR’s discretization toolkit &#8212; pyMOR v2019.2rc0+1317.g442d0d91 Manual</title>
    <link rel="stylesheet" href="_static/pymor.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Environment Variables" href="environment.html" />
    <link rel="prev" title="Technical Overview" href="technical_overview.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="environment.html" title="Environment Variables"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="technical_overview.html" title="Technical Overview"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyMOR v2019.2rc0+1317.g442d0d91 Manual</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial-1-using-pymors-discretization-toolkit">
<h1>Tutorial 1: Using pyMOR’s discretization toolkit<a class="headerlink" href="#tutorial-1-using-pymors-discretization-toolkit" title="Permalink to this headline">¶</a></h1>
<a class="reference download internal" href="tutorial01_full.ipynb">Download this page as a Jupyter notebook (with outputs)</a><p>pyMOR’s discretization toolkit allows to quickly build parametrized full
order models based on the NumPy/SciPy software stack. Currently
supported are stationary or instationary scalar PDEs of up to second
order with possibly nonlinear advection or reaction terms in one or two
spatial dimensions. Unstructured meshes can be imported in the Gmsh file
format.</p>
<p>In this tutorial we will focus on elliptic equations of the form</p>
<div class="math notranslate nohighlight">
\[-\nabla \cdot \big(\sigma(x, \mu) \nabla u(x, \mu) \big) = f(x, \mu),\quad x \in \Omega,\]</div>
<p>on the domain <span class="math notranslate nohighlight">\(\Omega:= (0, 1)^2 \subset \mathbb{R}^2\)</span> with data
functions <span class="math notranslate nohighlight">\(f(\cdot, \mu) \in L^2(\Omega)\)</span>,
<span class="math notranslate nohighlight">\(\sigma(\cdot, \mu) \in L^\infty(\Omega)\)</span>.</p>
<div class="section" id="a-first-equation-without-parameters">
<h2>A first equation without parameters<a class="headerlink" href="#a-first-equation-without-parameters" title="Permalink to this headline">¶</a></h2>
<p>First, let us assume that the source <span class="math notranslate nohighlight">\(f(x, \mu)\)</span> is an indicator
function of a circular disk with radius <span class="math notranslate nohighlight">\(0.3\)</span> and that
<span class="math notranslate nohighlight">\(\sigma(x, \mu)\)</span> is constant:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x, \mu) :=
\begin{cases}
   1 &amp; |x - (0.5, 0.5)| &lt; 0.3\\
   0 &amp; \text{otherwise}.
\end{cases} \quad\text{and}\quad
\sigma(x,\mu) :\equiv 1\end{split}\]</div>
<p>We start by importing commonly used pyMOR classes and methods from the
<a class="reference internal" href="generated/pymor.html#module-pymor.basic" title="pymor.basic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">basic</span></code></a> module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pymor.basic</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>To specify the problem at hand using pyMOR’s discretization toolkit, we
first need to specify the computational domain <span class="math notranslate nohighlight">\(\Omega\)</span>. Multiple
classes are available to define such domains in
in the <a class="reference internal" href="generated/pymor.analyticalproblems.html#module-pymor.analyticalproblems.domaindescriptions" title="pymor.analyticalproblems.domaindescriptions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">domaindescriptions</span></code></a> module,
which all derive from the <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.domaindescriptions.DomainDescription" title="pymor.analyticalproblems.domaindescriptions.DomainDescription"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainDescription</span></code></a> interface class.</p>
<p>In our case, we can use a <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.domaindescriptions.RectDomain" title="pymor.analyticalproblems.domaindescriptions.RectDomain"><code class="xref py py-class docutils literal notranslate"><span class="pre">RectDomain</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">domain</span> <span class="o">=</span> <span class="n">RectDomain</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
<p>Data functions are defined using classes which derive from
the <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.Function" title="pymor.analyticalproblems.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> interface. We specify the constant diffusivity <span class="math notranslate nohighlight">\(\sigma\)</span>
using a <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ConstantFunction" title="pymor.analyticalproblems.functions.ConstantFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantFunction</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diffusion</span> <span class="o">=</span> <span class="n">ConstantFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, the first argument is the function’s constant value. The second
argument is the spatial dimension of the domain the problem is defined
on.</p>
<p>For the definition of the source term <span class="math notranslate nohighlight">\(f\)</span> we use an
<a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ExpressionFunction" title="pymor.analyticalproblems.functions.ExpressionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpressionFunction</span></code></a> which is given an arbitrary Python expression
used to evaluate the function. In this expression, the coordinates at
which the function shall be evaluated are given as the variable <code class="docutils literal notranslate"><span class="pre">x</span></code>.
Many NumPy functions can be used directly. The entire NumPy module is
available under the name <code class="docutils literal notranslate"><span class="pre">np</span></code>.</p>
<p>Thus, to define <span class="math notranslate nohighlight">\(f\)</span> we could write</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span>
</pre></div>
</div>
<p>However, pyMOR <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.Function" title="pymor.analyticalproblems.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Functions</span></code></a> are required to be vectorized with respect
to the coordinate <code class="docutils literal notranslate"><span class="pre">x</span></code>. In the case of <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ExpressionFunction" title="pymor.analyticalproblems.functions.ExpressionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpressionFunction</span></code></a> this
means that <code class="docutils literal notranslate"><span class="pre">x</span></code> can be an arbitrary dimensional NumPy array of
coordinates where the last array index specifies the spacial dimension.
Therefore, the correct definition of <span class="math notranslate nohighlight">\(f\)</span> is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rhs</span> <span class="o">=</span> <span class="n">ExpressionFunction</span><span class="p">(</span><span class="s1">&#39;(sqrt( (x[...,0]-0.5)**2 + (x[...,1]-0.5)**2) &lt;= 0.3) * 1.&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">())</span>
</pre></div>
</div>
<p>Similarly to <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ConstantFunction" title="pymor.analyticalproblems.functions.ConstantFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantFunction</span></code></a>, the second argument is the dimension
of the computational domain. As the shape of the return value cannot be
easily inferred from the given string expression, it has to be provided
as a third argument to <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ConstantFunction" title="pymor.analyticalproblems.functions.ConstantFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantFunction</span></code></a>. For scalar functions we
provide the empty tuple <code class="docutils literal notranslate"><span class="pre">()</span></code>, for functions returning
three-dimensional vectors we would specify <code class="docutils literal notranslate"><span class="pre">(3,)</span></code>, and for functions
returning <span class="math notranslate nohighlight">\(2\times 2\)</span> matrices we would specify <code class="docutils literal notranslate"><span class="pre">(2,2)</span></code>.</p>
<p>Finally, the computational domain and all data functions are collected
in a <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.elliptic.StationaryProblem" title="pymor.analyticalproblems.elliptic.StationaryProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">StationaryProblem</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span> <span class="o">=</span> <span class="n">StationaryProblem</span><span class="p">(</span>
    <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
    <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span>
    <span class="n">rhs</span><span class="o">=</span><span class="n">rhs</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This problem definition can now be handed over to discretization methods
(see <a class="reference internal" href="generated/pymor.discretizers.builtin.html#module-pymor.discretizers.builtin" title="pymor.discretizers.builtin"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pymor.discretizers.builtin</span></code></a>) which assemble corresponding
discrete full order models. For finite elements, we use
<a class="reference internal" href="generated/pymor.discretizers.builtin.html#pymor.discretizers.builtin.cg.discretize_stationary_cg" title="pymor.discretizers.builtin.cg.discretize_stationary_cg"><code class="xref py py-func docutils literal notranslate"><span class="pre">discretize_stationary_cg</span></code></a>,
which receives the maximum mesh element diameter via the <code class="docutils literal notranslate"><span class="pre">diameter</span></code>
argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_cg</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting <a class="reference internal" href="generated/pymor.models.html#pymor.models.interface.Model" title="pymor.models.interface.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> can be <a class="reference internal" href="generated/pymor.models.html#pymor.models.interface.Model.solve" title="pymor.models.interface.Model.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solved</span></code></a>,
returning a <a class="reference internal" href="generated/pymor.vectorarrays.html#pymor.vectorarrays.interface.VectorArray" title="pymor.vectorarrays.interface.VectorArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorArray</span></code></a> with the solution data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, we visualize the solution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-8.png">png</a>, <a class="reference external" href=".//tutorial01-8.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-8.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-8.png" src="_images/tutorial01-8.png" />
</div>
<p>In case a specific grid type shall be used (<a class="reference internal" href="generated/pymor.discretizers.builtin.grids.html#pymor.discretizers.builtin.grids.rect.RectGrid" title="pymor.discretizers.builtin.grids.rect.RectGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">RectGrid</span></code></a> or
<a class="reference internal" href="generated/pymor.discretizers.builtin.grids.html#pymor.discretizers.builtin.grids.tria.TriaGrid" title="pymor.discretizers.builtin.grids.tria.TriaGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriaGrid</span></code></a>), the corresponding class has to be passed to the
discretizer as the <code class="docutils literal notranslate"><span class="pre">grid_type</span></code> argument. By using <a class="reference internal" href="generated/pymor.discretizers.builtin.grids.html#pymor.discretizers.builtin.grids.rect.RectGrid" title="pymor.discretizers.builtin.grids.rect.RectGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">RectGrid</span></code></a> we get
bilinear finite elements:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_cg</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">grid_type</span><span class="o">=</span><span class="n">RectGrid</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-9.png">png</a>, <a class="reference external" href=".//tutorial01-9.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-9.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-9.png" src="_images/tutorial01-9.png" />
</div>
<p>We get a finite volume model using
<a class="reference internal" href="generated/pymor.discretizers.builtin.html#pymor.discretizers.builtin.fv.discretize_stationary_fv" title="pymor.discretizers.builtin.fv.discretize_stationary_fv"><code class="xref py py-func docutils literal notranslate"><span class="pre">discretize_stationary_fv</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_fv</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">grid_type</span><span class="o">=</span><span class="n">TriaGrid</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-10.png">png</a>, <a class="reference external" href=".//tutorial01-10.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-10.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-10.png" src="_images/tutorial01-10.png" />
</div>
</div>
<div class="section" id="defining-boundary-conditions">
<h2>Defining boundary conditions<a class="headerlink" href="#defining-boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>As the vigilant reader will already have noticed, we did not specify any
boundary conditions when defining and solving our problem. When no
boundary conditions are specified, pyMOR’s discretization toolkit will
assume that homogeneous Dirichlet conditions are implied over the entire
boundary of <span class="math notranslate nohighlight">\(\Omega\)</span>.</p>
<p>As a the next example, let us now assume that the data functions are
given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x,\mu) \equiv 0 \quad\text{and}\quad
\sigma(x, \mu) :=
\begin{cases}
   0.001 &amp; |x - (0.5, 0.5)| &lt; 0.3\\
   1 &amp; \text{otherwise,}
\end{cases}\end{split}\]</div>
<p>and that we have the following mixed boundary conditions</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
- \sigma_(x, \mu) \nabla u(x, \mu) \cdot n &amp;= g_N(x), &amp;&amp;x \in (0,1) \times \{0\} =: \Omega_N \\
u(x, \mu) &amp;= 0, &amp;&amp;x \in \partial\Omega \setminus \Omega_N,
\end{align}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(g_N(x) \equiv -1\)</span>.</p>
<p>Before solving this problem, let us first silence pyMOR’s verbose log
messages for the rest of this tutorial using the <a class="reference internal" href="generated/pymor.core.html#pymor.core.logger.set_log_levels" title="pymor.core.logger.set_log_levels"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_log_levels</span></code></a>
method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">set_log_levels</span><span class="p">({</span><span class="s1">&#39;pymor&#39;</span><span class="p">:</span> <span class="s1">&#39;WARN&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>To impose the right boundary conditions we need to declare which type of
boundary condition should be active on which part of
<span class="math notranslate nohighlight">\(\partial\Omega\)</span> when defining the computational domain:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">domain</span> <span class="o">=</span> <span class="n">RectDomain</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;neumann&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then all we need to pass the Neumann data function <span class="math notranslate nohighlight">\(g_N\)</span> to the
<a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.elliptic.StationaryProblem" title="pymor.analyticalproblems.elliptic.StationaryProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">StationaryProblem</span></code></a>. Here, we can use again a <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ConstantFunction" title="pymor.analyticalproblems.functions.ConstantFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantFunction</span></code></a>.
The diffusivity can be defined similarly as above:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">neumann_data</span> <span class="o">=</span> <span class="n">ConstantFunction</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">diffusion</span> <span class="o">=</span> <span class="n">ExpressionFunction</span><span class="p">(</span><span class="s1">&#39;1. - (sqrt( (x[...,0]-0.5)**2 + (x[...,1]-0.5)**2) &lt;= 0.3) * 0.999&#39;</span> <span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">())</span>

<span class="n">problem</span> <span class="o">=</span> <span class="n">StationaryProblem</span><span class="p">(</span>
    <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
    <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span>
    <span class="n">neumann_data</span><span class="o">=</span><span class="n">neumann_data</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Finally, we discretize and solve:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_cg</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">32</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-14.png">png</a>, <a class="reference external" href=".//tutorial01-14.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-14.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-14.png" src="_images/tutorial01-14.png" />
</div>
</div>
<div class="section" id="another-example">
<h2>Another example<a class="headerlink" href="#another-example" title="Permalink to this headline">¶</a></h2>
<p>Even with a single <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ExpressionFunction" title="pymor.analyticalproblems.functions.ExpressionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpressionFunction</span></code></a> we can build many different examples.
For instance, to let <span class="math notranslate nohighlight">\(\sigma\)</span> be given by a periodic pattern of
<span class="math notranslate nohighlight">\(K\times K\)</span> circular disks of radius <span class="math notranslate nohighlight">\(0.3/K\)</span> we can use the
following definition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diffusion</span> <span class="o">=</span> <span class="n">ExpressionFunction</span><span class="p">(</span>
    <span class="s1">&#39;1. - (sqrt( (np.mod(x[...,0],1./K)-0.5/K)**2 + (np.mod(x[...,1],1./K)-0.5/K)**2) &lt;= 0.3/K) * 0.999&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span> <span class="p">(),</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Here, we have used the <code class="docutils literal notranslate"><span class="pre">values</span></code> parameter of <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ExpressionFunction" title="pymor.analyticalproblems.functions.ExpressionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpressionFunction</span></code></a> to
make <code class="docutils literal notranslate"><span class="pre">K</span></code> available as an additional constant in the defining
expression. In particular, we can easily change <code class="docutils literal notranslate"><span class="pre">K</span></code> programatically
without having to resort to string manipulations. The solution looks
like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span> <span class="o">=</span> <span class="n">StationaryProblem</span><span class="p">(</span>
    <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
    <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span>
    <span class="n">neumann_data</span><span class="o">=</span><span class="n">neumann_data</span>
<span class="p">)</span>


<span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_cg</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-16.png">png</a>, <a class="reference external" href=".//tutorial01-16.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-16.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-16.png" src="_images/tutorial01-16.png" />
</div>
</div>
<div class="section" id="data-functions-defined-from-pixel-graphics">
<h2>Data functions defined from pixel graphics<a class="headerlink" href="#data-functions-defined-from-pixel-graphics" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.BitmapFunction" title="pymor.analyticalproblems.functions.BitmapFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">BitmapFunction</span></code></a> uses the Python Imaging Library (PIL) to read gray
scale images in various image file formats. The resulting
two-dimensional NumPy array of pixel values defines a piecewise constant
data function on a rectangular domain, where the range of the function
(from black to white) is specified via the <code class="docutils literal notranslate"><span class="pre">range</span></code> parameter. For
instance, when using a <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.BitmapFunction" title="pymor.analyticalproblems.functions.BitmapFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">BitmapFunction</span></code></a> for <span class="math notranslate nohighlight">\(\sigma\)</span> with the
following graphic stored in <code class="docutils literal notranslate"><span class="pre">RB.png</span></code>:</p>
<img alt="_images/RB.png" src="_images/RB.png" />
<p>and a range of <code class="docutils literal notranslate"><span class="pre">[0.001</span> <span class="pre">1]</span></code> we obtain:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diffusion</span> <span class="o">=</span> <span class="n">BitmapFunction</span><span class="p">(</span><span class="s1">&#39;RB.png&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">StationaryProblem</span><span class="p">(</span>
    <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
    <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span>
    <span class="n">neumann_data</span><span class="o">=</span><span class="n">neumann_data</span>
<span class="p">)</span>

<span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_cg</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-17.png">png</a>, <a class="reference external" href=".//tutorial01-17.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-17.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-17.png" src="_images/tutorial01-17.png" />
</div>
<p>The displayed warning results from the fact that the used image file has
an additinal channel of transparancy values (alpha channel) and can be
ignored.</p>
</div>
<div class="section" id="a-parametric-problem">
<h2>A parametric problem<a class="headerlink" href="#a-parametric-problem" title="Permalink to this headline">¶</a></h2>
<p>Now, let us consider the Neumann data function:</p>
<div class="math notranslate nohighlight">
\[g_N((x_0, x_1), \mu_{neum}) := -\cos(\pi \cdot x_0)^2 \cdot\mu_{neum}\]</div>
<p>with a single <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Parameters" title="pymor.parameters.base.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code></a> <span class="math notranslate nohighlight">\(\mu_{neum} \in \mathbb{R}\)</span>.</p>
<p>In pyMOR, <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Mu" title="pymor.parameters.base.Mu"><code class="xref py py-class docutils literal notranslate"><span class="pre">parameter</span> <span class="pre">values</span></code></a> are specified as a dictionary of one-dimensional
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumPy</span> <span class="pre">arrays</span></code></a>. Each value in the dictionary must have a correct size specified by the
<a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Parameters" title="pymor.parameters.base.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a> of the <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.ParametricObject" title="pymor.parameters.base.ParametricObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParametricObject</span></code></a>. In this example we have a single scalar
valued parameter which we call <code class="docutils literal notranslate"><span class="pre">'neum'</span></code>. Thus, the <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Parameters" title="pymor.parameters.base.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a> of the function
will be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;neum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<p>We can then make the following definition of the Neumann data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">neumann_data</span> <span class="o">=</span> <span class="n">ExpressionFunction</span><span class="p">(</span><span class="s1">&#39;-cos(pi*x[...,0])**2*neum[0]&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(),</span> <span class="n">parameters</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;neum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>Similar to the range of the function, pyMOR cannot infer from the given
string expression the parameters used in the expression, so these
<a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Parameters" title="pymor.parameters.base.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a> have to be provided as the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> argument.
The individual parameters are then available as variables in
the expression.</p>
<p>We can then proceed as usual and automatically obtain a parametric
<a class="reference internal" href="generated/pymor.models.html#pymor.models.interface.Model" title="pymor.models.interface.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diffusion</span> <span class="o">=</span> <span class="n">ExpressionFunction</span><span class="p">(</span>
    <span class="s1">&#39;1. - (sqrt( (np.mod(x[...,0],1./K)-0.5/K)**2 + (np.mod(x[...,1],1./K)-0.5/K)**2) &lt;= 0.3/K) * 0.999&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span> <span class="p">(),</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">StationaryProblem</span><span class="p">(</span>
    <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
    <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span>
    <span class="n">neumann_data</span><span class="o">=</span><span class="n">neumann_data</span>
<span class="p">)</span>

<span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_cg</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">parameters</span>
</pre></div>
</div>
<div class="highlight-ipythonconsole notranslate"><div class="highlight"><pre><span></span><span class="go">Parameters({neum: 1})</span>
</pre></div>
</div>
<p>When solving the model, we now need to specify appropriate
<a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Mu" title="pymor.parameters.base.Mu"><code class="xref py py-class docutils literal notranslate"><span class="pre">parameter</span> <span class="pre">values</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">({</span><span class="s1">&#39;neum&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]}))</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-20.png">png</a>, <a class="reference external" href=".//tutorial01-20.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-20.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-20.png" src="_images/tutorial01-20.png" />
</div>
<p>For the <a class="reference internal" href="generated/pymor.models.html#pymor.models.interface.Model.solve" title="pymor.models.interface.Model.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve</span></code></a> method, the
parameter value can also be specified as a single number:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-21.png">png</a>, <a class="reference external" href=".//tutorial01-21.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-21.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-21.png" src="_images/tutorial01-21.png" />
</div>
</div>
<div class="section" id="multiple-parameters">
<h2>Multiple parameters<a class="headerlink" href="#multiple-parameters" title="Permalink to this headline">¶</a></h2>
<p>Next we also want to to parametrize the diffusivity in the
<span class="math notranslate nohighlight">\(K \times K\)</span> circular disks by a scalar factor
<span class="math notranslate nohighlight">\(\mu_{diffu}\)</span>. To this end we define:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diffusion</span> <span class="o">=</span> <span class="n">ExpressionFunction</span><span class="p">(</span>
    <span class="s1">&#39;1. - (sqrt( (np.mod(x[...,0],1./K)-0.5/K)**2 + (np.mod(x[...,1],1./K)-0.5/K)**2) &lt;= 0.3/K) * (1 - diffu[0])&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span> <span class="p">(),</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="n">parameters</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;diffu&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We proceed as usual:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span> <span class="o">=</span> <span class="n">StationaryProblem</span><span class="p">(</span>
    <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
    <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span>
    <span class="n">neumann_data</span><span class="o">=</span><span class="n">neumann_data</span>
<span class="p">)</span>

<span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_cg</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">parameters</span>
</pre></div>
</div>
<div class="highlight-ipythonconsole notranslate"><div class="highlight"><pre><span></span><span class="go">Parameters({diffu: 1, neum: 1})</span>
</pre></div>
</div>
<p>As we can see, pyMOR automatically derives that in this case the model
depends on two <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Parameters" title="pymor.parameters.base.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>, and we have to provide two values
when solving the model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">({</span><span class="s1">&#39;diffu&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;neum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-24.png">png</a>, <a class="reference external" href=".//tutorial01-24.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-24.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-24.png" src="_images/tutorial01-24.png" />
</div>
<p>For <a class="reference internal" href="generated/pymor.models.html#pymor.models.interface.Model.solve" title="pymor.models.interface.Model.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve</span></code></a> we can also
simply pass a list of parameter values, in which case
pyMOR assumes an alphabetical ordering of the parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//tutorial01-25.png">png</a>, <a class="reference external" href=".//tutorial01-25.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-25.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/tutorial01-25.png" src="_images/tutorial01-25.png" />
</div>
</div>
<div class="section" id="parameter-separability">
<h2>Parameter-separability<a class="headerlink" href="#parameter-separability" title="Permalink to this headline">¶</a></h2>
<p>For the generation of online-efficient reduced order models, it is often
crucial that data functions are parameter separable. We call a
parametric function <code class="docutils literal notranslate"><span class="pre">f(x,</span> <span class="pre">mu)</span></code> parameter separable if it admits a
decomposition</p>
<div class="math notranslate nohighlight">
\[f(x, \mu) = \sum_{q=1}^Q f_q(x) \cdot \theta_q(\mu)\]</div>
<p>where the <span class="math notranslate nohighlight">\(f_q\)</span> are non-parametric and the <em>parameter
functionals</em> <span class="math notranslate nohighlight">\(\theta_q\)</span> map parameters to real numbers.</p>
<p>To model such a decomposition using pyMOR’s discretization toolkit, we
specify the <span class="math notranslate nohighlight">\(f_q\)</span> as non-parametric <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.Function" title="pymor.analyticalproblems.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Functions</span></code></a>, the
<span class="math notranslate nohighlight">\(\theta_q\)</span> are represented by <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.functionals.ParameterFunctional" title="pymor.parameters.functionals.ParameterFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterFunctionals</span></code></a> and the
given sum decomposition is represented by a <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.LincombFunction" title="pymor.analyticalproblems.functions.LincombFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LincombFunction</span></code></a> of these
objects.</p>
<p>As an example let us go back to the case where the diffusivity is
represented by indicator functions of point sets forming the letters
<code class="docutils literal notranslate"><span class="pre">RB</span></code>. We now want to parametrize the diffusivity in the individual
letters. This admits a decomposition of the form</p>
<div class="math notranslate nohighlight">
\[\sigma(x,y) = 1 + f_R \cdot (\mu_R - 1) + f_B \cdot (\mu_L - 1)\]</div>
<p>Again, we define <span class="math notranslate nohighlight">\(f_R\)</span> and <span class="math notranslate nohighlight">\(f_L\)</span> as <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.BitmapFunction" title="pymor.analyticalproblems.functions.BitmapFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">BitmapFunctions</span></code></a> for
the following image files:</p>
<img alt="_images/R.png" src="_images/R.png" />
<img alt="_images/B.png" src="_images/B.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f_R</span> <span class="o">=</span> <span class="n">BitmapFunction</span><span class="p">(</span><span class="s1">&#39;R.png&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">f_B</span> <span class="o">=</span> <span class="n">BitmapFunction</span><span class="p">(</span><span class="s1">&#39;B.png&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Next we need to define the <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.functionals.ParameterFunctional" title="pymor.parameters.functionals.ParameterFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterFunctionals</span></code></a></p>
<div class="math notranslate nohighlight">
\[\theta_R(\mu) = \mu_R - 1 \quad\text{and}\quad \theta_B(\mu) = \mu_B - 1.\]</div>
<p>Similar to an <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.ExpressionFunction" title="pymor.analyticalproblems.functions.ExpressionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpressionFunction</span></code></a>, we can use
<a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.functionals.ExpressionParameterFunctional" title="pymor.parameters.functionals.ExpressionParameterFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExpressionParameterFunctionals</span></code></a> for that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">theta_R</span> <span class="o">=</span> <span class="n">ExpressionParameterFunctional</span><span class="p">(</span><span class="s1">&#39;R[0] - 1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">theta_B</span> <span class="o">=</span> <span class="n">ExpressionParameterFunctional</span><span class="p">(</span><span class="s1">&#39;B[0] - 1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>Note that the second argument is again the <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Parameters" title="pymor.parameters.base.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>
that are used in the expression. Finally, we form the linear
combination using a <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.LincombFunction" title="pymor.analyticalproblems.functions.LincombFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LincombFunction</span></code></a> which is given a list of
<a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.Function" title="pymor.analyticalproblems.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Functions</span></code></a> as the first and a corresponding list of
<a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.functionals.ParameterFunctional" title="pymor.parameters.functionals.ParameterFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterFunctionals</span></code></a> or constants as the second argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diffusion</span> <span class="o">=</span> <span class="n">LincombFunction</span><span class="p">(</span>
    <span class="p">[</span><span class="n">ConstantFunction</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">f_R</span><span class="p">,</span> <span class="n">f_B</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="n">theta_R</span><span class="p">,</span> <span class="n">theta_B</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">diffusion</span><span class="o">.</span><span class="n">parameters</span>
</pre></div>
</div>
<div class="highlight-ipythonconsole notranslate"><div class="highlight"><pre><span></span><span class="go">Parameters({B: 1, R: 1})</span>
</pre></div>
</div>
<p>Again, pyMOR automatically derives that the evaluation of <code class="docutils literal notranslate"><span class="pre">diffusion</span></code>
depends on the two <a class="reference internal" href="generated/pymor.parameters.html#pymor.parameters.base.Parameters" title="pymor.parameters.base.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a> <code class="docutils literal notranslate"><span class="pre">'B'</span></code> and <code class="docutils literal notranslate"><span class="pre">'R'</span></code>. Now, we can
proceed as usual:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span> <span class="o">=</span> <span class="n">StationaryProblem</span><span class="p">(</span>
    <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
    <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span>
    <span class="n">neumann_data</span><span class="o">=</span><span class="n">ConstantFunction</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">discretize_stationary_cg</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">]))</span>
<span class="n">m</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<div class="figure align-default" id="id1">
<img alt="_images/tutorial01-29_00.png" src="_images/tutorial01-29_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href=".//tutorial01-29_00.png">png</a>, <a class="reference external" href=".//tutorial01-29_00.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-29_00.pdf">pdf</a>)</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id2">
<img alt="_images/tutorial01-29_01.png" src="_images/tutorial01-29_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href=".//tutorial01-29_01.png">png</a>, <a class="reference external" href=".//tutorial01-29_01.hires.png">hires.png</a>, <a class="reference external" href=".//tutorial01-29_01.pdf">pdf</a>)</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>Looking at the <a class="reference internal" href="generated/pymor.models.html#pymor.models.interface.Model" title="pymor.models.interface.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> <code class="docutils literal notranslate"><span class="pre">m</span></code>, we can see that the decomposition of
<span class="math notranslate nohighlight">\(\sigma\)</span> has been preserved by the discretizer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">operator</span>
</pre></div>
</div>
<div class="highlight-ipythonconsole notranslate"><div class="highlight"><pre><span></span><span class="go">LincombOperator(</span>
<span class="go">    (NumpyMatrixOperator(&lt;20201x20201 sparse, 140601 nnz&gt;, source_id=&#39;STATE&#39;, range_id=&#39;STATE&#39;, name=&#39;boundary_part&#39;),</span>
<span class="go">     NumpyMatrixOperator(&lt;20201x20201 sparse, 140601 nnz&gt;, source_id=&#39;STATE&#39;, range_id=&#39;STATE&#39;, name=&#39;diffusion_0&#39;),</span>
<span class="go">     NumpyMatrixOperator(&lt;20201x20201 sparse, 140601 nnz&gt;, source_id=&#39;STATE&#39;, range_id=&#39;STATE&#39;, name=&#39;diffusion_1&#39;),</span>
<span class="go">     NumpyMatrixOperator(&lt;20201x20201 sparse, 140601 nnz&gt;, source_id=&#39;STATE&#39;, range_id=&#39;STATE&#39;, name=&#39;diffusion_2&#39;)),</span>
<span class="go">    (1.0, 1.0, ExpressionParameterFunctional(&#39;R[0] - 1&#39;, {R: 1}), ExpressionParameterFunctional(&#39;B[0] - 1&#39;, {B: 1})),</span>
<span class="go">    name=&#39;ellipticOperator&#39;)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.LincombFunction" title="pymor.analyticalproblems.functions.LincombFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LincombFunction</span></code></a> has become a <a class="reference internal" href="generated/pymor.operators.html#pymor.operators.constructions.LincombOperator" title="pymor.operators.constructions.LincombOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LincombOperator</span></code></a>, with the same
linear coefficients but the <a class="reference internal" href="generated/pymor.analyticalproblems.html#pymor.analyticalproblems.functions.BitmapFunction" title="pymor.analyticalproblems.functions.BitmapFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">BitmapFunctions</span></code></a> replaced by
corresponding stiffness matrices. Note that an additional summand
appears which ensures correct enforcement of Dirichlet boundary values
for all possible parameter value combinations.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial 1: Using pyMOR’s discretization toolkit</a><ul>
<li><a class="reference internal" href="#a-first-equation-without-parameters">A first equation without parameters</a></li>
<li><a class="reference internal" href="#defining-boundary-conditions">Defining boundary conditions</a></li>
<li><a class="reference internal" href="#another-example">Another example</a></li>
<li><a class="reference internal" href="#data-functions-defined-from-pixel-graphics">Data functions defined from pixel graphics</a></li>
<li><a class="reference internal" href="#a-parametric-problem">A parametric problem</a></li>
<li><a class="reference internal" href="#multiple-parameters">Multiple parameters</a></li>
<li><a class="reference internal" href="#parameter-separability">Parameter-separability</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="technical_overview.html"
                        title="previous chapter">Technical Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="environment.html"
                        title="next chapter">Environment Variables</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial01.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="environment.html" title="Environment Variables"
             >next</a> |</li>
        <li class="right" >
          <a href="technical_overview.html" title="Technical Overview"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyMOR v2019.2rc0+1317.g442d0d91 Manual</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2020 pyMOR developers and contributors.
      Last updated on Jul 03, 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  </body>
</html>